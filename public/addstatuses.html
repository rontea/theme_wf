<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TODO Manager</title>
</head>
<style>
    .editableText {
        border: 1px solid #ccc;
        padding: 5px;
        min-height: 20px;
        cursor: pointer;
        width: 200px;
        display: inline-block;
        margin-bottom: 10px;
    }

    .textInput {
        display: none;
        width: 200px;
    }

    .savingIndicator {
        display: none;
        margin-left: 10px;
        font-size: 14px;
        color: green;
    }

    .successMessage {
    color: green;
    padding: 2px;
    background-color: orange;
    display: none;
    }

</style>

<body>

  <p> <a href="./" class="link">home</a>  </p>
  <h1>Edit/Add Statuses</h1>

  <div id="fieldsContainer">
    <!-- Initial editable field will be generated by JavaScript -->
  </div>

  <div class="error" id="error"></div>

  <script>
   

    let tempStatuses = [];
    let fieldCount = 0; // Keeps track of the number of fields

    function createEditableField(id) {
        const container = document.createElement('div');
        container.id = id;

        const editableText = document.createElement('div');
        editableText.id = `${id}Text`;
        editableText.className = 'editableText';
        editableText.textContent = 'Click to edit';

        const textInput = document.createElement('input');
        textInput.id = `${id}Input`;
        textInput.className = 'textInput';
        textInput.type = 'text';

        const savingIndicator = document.createElement('span');
        savingIndicator.id = `${id}Saving`;
        savingIndicator.className = 'savingIndicator';
        savingIndicator.textContent = 'Saving...';

        container.appendChild(editableText);
        container.appendChild(textInput);
        container.appendChild(savingIndicator);

        document.getElementById('fieldsContainer').appendChild(container);

        makeEditable(id); // Initialize the editable field behavior
    }

    function makeEditable(id) {
      const editableText = document.getElementById(`${id}Text`);
      const textInput = document.getElementById(`${id}Input`);
      const savingIndicator = document.getElementById(`${id}Saving`);

      // Switch to editable mode
      editableText.addEventListener('click', () => {
        textInput.value = editableText.textContent.trim() === 'Click to edit' ? '' : editableText.textContent.trim();
        editableText.style.display = 'none';
        textInput.style.display = 'inline-block';
        textInput.focus();
      });

      // Save the change and switch back to non-editable mode
        async function saveChange() {
            const newValue = textInput.value.trim();

            // Update the UI with the new value
            editableText.textContent = newValue === '' ? 'Click to edit' : newValue;
            textInput.style.display = 'none';
            editableText.style.display = 'inline-block';

            // Show the saving indicator
      

            if(newValue !=='') {
               
                savingIndicator.style.display = 'inline-block';
                tempStatuses[id] = newValue;
                savingIndicator.textContent = 'saved';
                console.log(tempStatuses);
            }else {
                savingIndicator.textContent = 'removed';
                
            }

                console.log(newValue);
                console.log(id);
                console.log(fieldCount);
              

            // If this is a new field and the value is valid, create a new editable field
            if (newValue !== '' && id === `field${fieldCount}`) {
                addNewEditableField();
            }

              
                
        }
 
      // Save the change when the user presses Enter or clicks outside the input
      textInput.addEventListener('blur', saveChange);

      textInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          
            console.log('out');
            saveChange();
        }
      });
     
    }

    function addNewEditableField() {
      fieldCount++;
      createEditableField(`field${fieldCount}`);
    }

    // Initialize with one editable field
    addNewEditableField();
     
      


  </script>
</body>
</html>
